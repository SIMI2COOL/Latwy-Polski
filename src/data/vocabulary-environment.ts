import { VocabularyWord } from '@/types';

export const environmentVocabulary: VocabularyWord[] = [
  // KOSMOS (Space)
  { id: 'space_001', polish: 'słońce', english: 'sun', category: 'environment', subcategory: 'space', difficulty: 'beginner' },
  { id: 'space_002', polish: 'księżyc', english: 'moon', category: 'environment', subcategory: 'space', difficulty: 'beginner' },
  { id: 'space_003', polish: 'gwiazda', english: 'star', category: 'environment', subcategory: 'space', difficulty: 'beginner' },
  { id: 'space_004', polish: 'planeta', english: 'planet', category: 'environment', subcategory: 'space', difficulty: 'beginner' },
  { id: 'space_005', polish: 'galaktyka', english: 'galaxy', category: 'environment', subcategory: 'space', difficulty: 'intermediate' },
  { id: 'space_006', polish: 'kometa', english: 'comet', category: 'environment', subcategory: 'space', difficulty: 'intermediate' },
  { id: 'space_007', polish: 'meteor', english: 'meteor', category: 'environment', subcategory: 'space', difficulty: 'intermediate' },
  { id: 'space_008', polish: 'satelita', english: 'satellite', category: 'environment', subcategory: 'space', difficulty: 'intermediate' },
  { id: 'space_009', polish: 'statek kosmiczny', english: 'spacecraft', category: 'environment', subcategory: 'space', difficulty: 'intermediate' },
  { id: 'space_010', polish: 'astronauta', english: 'astronaut', category: 'environment', subcategory: 'space', difficulty: 'intermediate' },

  // ZIEMIA (Earth)
  { id: 'earth_001', polish: 'kontynent', english: 'continent', category: 'environment', subcategory: 'earth', difficulty: 'intermediate' },
  { id: 'earth_002', polish: 'ocean', english: 'ocean', category: 'environment', subcategory: 'earth', difficulty: 'beginner' },
  { id: 'earth_003', polish: 'morze', english: 'sea', category: 'environment', subcategory: 'earth', difficulty: 'beginner' },
  { id: 'earth_004', polish: 'wyspa', english: 'island', category: 'environment', subcategory: 'earth', difficulty: 'beginner' },
  { id: 'earth_005', polish: 'półwysep', english: 'peninsula', category: 'environment', subcategory: 'earth', difficulty: 'intermediate' },
  { id: 'earth_006', polish: 'zatoka', english: 'bay', category: 'environment', subcategory: 'earth', difficulty: 'intermediate' },
  { id: 'earth_007', polish: 'wybrzeże', english: 'coast', category: 'environment', subcategory: 'earth', difficulty: 'intermediate' },
  { id: 'earth_008', polish: 'plaża', english: 'beach', category: 'environment', subcategory: 'earth', difficulty: 'beginner' },
  { id: 'earth_009', polish: 'klif', english: 'cliff', category: 'environment', subcategory: 'earth', difficulty: 'intermediate' },
  { id: 'earth_010', polish: 'rafa koralowa', english: 'coral reef', category: 'environment', subcategory: 'earth', difficulty: 'advanced' },

  // KRAJOBRAZ (Landscape)
  { id: 'landscape_001', polish: 'góra', english: 'mountain', category: 'environment', subcategory: 'landscape', difficulty: 'beginner' },
  { id: 'landscape_002', polish: 'wzgórze', english: 'hill', category: 'environment', subcategory: 'landscape', difficulty: 'intermediate' },
  { id: 'landscape_003', polish: 'dolina', english: 'valley', category: 'environment', subcategory: 'landscape', difficulty: 'intermediate' },
  { id: 'landscape_004', polish: 'wulkan', english: 'volcano', category: 'environment', subcategory: 'landscape', difficulty: 'intermediate' },
  { id: 'landscape_005', polish: 'jaskinia', english: 'cave', category: 'environment', subcategory: 'landscape', difficulty: 'intermediate' },
  { id: 'landscape_006', polish: 'pustynia', english: 'desert', category: 'environment', subcategory: 'landscape', difficulty: 'intermediate' },
  { id: 'landscape_007', polish: 'las', english: 'forest', category: 'environment', subcategory: 'landscape', difficulty: 'beginner' },
  { id: 'landscape_008', polish: 'dżungla', english: 'jungle', category: 'environment', subcategory: 'landscape', difficulty: 'intermediate' },
  { id: 'landscape_009', polish: 'łąka', english: 'meadow', category: 'environment', subcategory: 'landscape', difficulty: 'intermediate' },
  { id: 'landscape_010', polish: 'pole', english: 'field', category: 'environment', subcategory: 'landscape', difficulty: 'beginner' },

  // POGODA (Weather)
  { id: 'weather_001', polish: 'pogoda', english: 'weather', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },
  { id: 'weather_002', polish: 'słońce', english: 'sunshine', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },
  { id: 'weather_003', polish: 'deszcz', english: 'rain', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },
  { id: 'weather_004', polish: 'śnieg', english: 'snow', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },
  { id: 'weather_005', polish: 'grad', english: 'hail', category: 'environment', subcategory: 'weather', difficulty: 'intermediate' },
  { id: 'weather_006', polish: 'wiatr', english: 'wind', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },
  { id: 'weather_007', polish: 'burza', english: 'storm', category: 'environment', subcategory: 'weather', difficulty: 'intermediate' },
  { id: 'weather_008', polish: 'piorun', english: 'lightning', category: 'environment', subcategory: 'weather', difficulty: 'intermediate' },
  { id: 'weather_009', polish: 'grzmot', english: 'thunder', category: 'environment', subcategory: 'weather', difficulty: 'intermediate' },
  { id: 'weather_010', polish: 'mgła', english: 'fog', category: 'environment', subcategory: 'weather', difficulty: 'intermediate' },
  { id: 'weather_011', polish: 'chmura', english: 'cloud', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },
  { id: 'weather_012', polish: 'tęcza', english: 'rainbow', category: 'environment', subcategory: 'weather', difficulty: 'intermediate' },
  { id: 'weather_013', polish: 'temperatura', english: 'temperature', category: 'environment', subcategory: 'weather', difficulty: 'intermediate' },
  { id: 'weather_014', polish: 'gorąco', english: 'hot', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },
  { id: 'weather_015', polish: 'zimno', english: 'cold', category: 'environment', subcategory: 'weather', difficulty: 'beginner' },

  // ZWIERZĘTA (Animals)
  { id: 'animals_001', polish: 'pies', english: 'dog', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_002', polish: 'kot', english: 'cat', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_003', polish: 'koń', english: 'horse', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_004', polish: 'krowa', english: 'cow', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_005', polish: 'świnia', english: 'pig', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_006', polish: 'owca', english: 'sheep', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_007', polish: 'koza', english: 'goat', category: 'environment', subcategory: 'animals', difficulty: 'intermediate' },
  { id: 'animals_008', polish: 'kurczak', english: 'chicken', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_009', polish: 'królik', english: 'rabbit', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_010', polish: 'słoń', english: 'elephant', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_011', polish: 'lew', english: 'lion', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_012', polish: 'tygrys', english: 'tiger', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_013', polish: 'niedźwiedź', english: 'bear', category: 'environment', subcategory: 'animals', difficulty: 'intermediate' },
  { id: 'animals_014', polish: 'małpa', english: 'monkey', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_015', polish: 'żyrafa', english: 'giraffe', category: 'environment', subcategory: 'animals', difficulty: 'intermediate' },
  { id: 'animals_016', polish: 'zebra', english: 'zebra', category: 'environment', subcategory: 'animals', difficulty: 'beginner' },
  { id: 'animals_017', polish: 'wilk', english: 'wolf', category: 'environment', subcategory: 'animals', difficulty: 'intermediate' },
  { id: 'animals_018', polish: 'lis', english: 'fox', category: 'environment', subcategory: 'animals', difficulty: 'intermediate' },
  { id: 'animals_019', polish: 'jeleń', english: 'deer', category: 'environment', subcategory: 'animals', difficulty: 'intermediate' },
  { id: 'animals_020', polish: 'wiewiórka', english: 'squirrel', category: 'environment', subcategory: 'animals', difficulty: 'intermediate' },

  // PTAKI (Birds)
  { id: 'birds_001', polish: 'ptak', english: 'bird', category: 'environment', subcategory: 'birds', difficulty: 'beginner' },
  { id: 'birds_002', polish: 'orzeł', english: 'eagle', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },
  { id: 'birds_003', polish: 'sowa', english: 'owl', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },
  { id: 'birds_004', polish: 'gołąb', english: 'pigeon', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },
  { id: 'birds_005', polish: 'wrona', english: 'crow', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },
  { id: 'birds_006', polish: 'papuga', english: 'parrot', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },
  { id: 'birds_007', polish: 'pingwin', english: 'penguin', category: 'environment', subcategory: 'birds', difficulty: 'beginner' },
  { id: 'birds_008', polish: 'łabędź', english: 'swan', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },
  { id: 'birds_009', polish: 'flamingo', english: 'flamingo', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },
  { id: 'birds_010', polish: 'pelikan', english: 'pelican', category: 'environment', subcategory: 'birds', difficulty: 'intermediate' },

  // ROŚLINY (Plants)
  { id: 'plants_001', polish: 'drzewo', english: 'tree', category: 'environment', subcategory: 'plants', difficulty: 'beginner' },
  { id: 'plants_002', polish: 'kwiat', english: 'flower', category: 'environment', subcategory: 'plants', difficulty: 'beginner' },
  { id: 'plants_003', polish: 'róża', english: 'rose', category: 'environment', subcategory: 'plants', difficulty: 'beginner' },
  { id: 'plants_004', polish: 'tulipan', english: 'tulip', category: 'environment', subcategory: 'plants', difficulty: 'intermediate' },
  { id: 'plants_005', polish: 'słonecznik', english: 'sunflower', category: 'environment', subcategory: 'plants', difficulty: 'intermediate' },
  { id: 'plants_006', polish: 'trawa', english: 'grass', category: 'environment', subcategory: 'plants', difficulty: 'beginner' },
  { id: 'plants_007', polish: 'krzak', english: 'bush', category: 'environment', subcategory: 'plants', difficulty: 'intermediate' },
  { id: 'plants_008', polish: 'liść', english: 'leaf', category: 'environment', subcategory: 'plants', difficulty: 'beginner' },
  { id: 'plants_009', polish: 'gałąź', english: 'branch', category: 'environment', subcategory: 'plants', difficulty: 'intermediate' },
  { id: 'plants_010', polish: 'korzeń', english: 'root', category: 'environment', subcategory: 'plants', difficulty: 'intermediate' },
  { id: 'plants_011', polish: 'nasiono', english: 'seed', category: 'environment', subcategory: 'plants', difficulty: 'intermediate' },
  { id: 'plants_012', polish: 'kaktus', english: 'cactus', category: 'environment', subcategory: 'plants', difficulty: 'intermediate' },
];

export async function seedEnvironmentVocabulary() {
  const { db, removeDuplicateVocabulary } = await import('@/utils/database');
  
  try {
    // First, remove any existing duplicates in the environment category
    await removeDuplicateVocabulary();
    
    // Get existing environment vocabulary
    const existingEnvironment = await db.vocabulary.where('category').equals('environment').toArray();
    const existingIds = new Set(existingEnvironment.map(w => w.id));
    
    // Also check for duplicates by Polish word + subcategory (case-insensitive)
    const existingByPolish = new Map<string, VocabularyWord>();
    for (const word of existingEnvironment) {
      const key = `${word.subcategory}_${word.polish.toLowerCase().trim()}`;
      if (!existingByPolish.has(key)) {
        existingByPolish.set(key, word);
      }
    }
    
    // Filter out words that already exist (by ID or by Polish word + subcategory)
    const newWords = environmentVocabulary.filter(word => {
      if (existingIds.has(word.id)) return false;
      const key = `${word.subcategory}_${word.polish.toLowerCase().trim()}`;
      return !existingByPolish.has(key);
    });
    
    if (newWords.length > 0) {
      await db.vocabulary.bulkAdd(newWords);
      console.log(`✅ Added ${newWords.length} new environment words`);
    }
    
    // Remove duplicates again after adding (in case of any edge cases)
    await removeDuplicateVocabulary();
    
    // Update total word count
    const totalCount = await db.vocabulary.where('category').equals('environment').count();
    await db.categories.update('environment', { totalWords: totalCount });
    console.log(`✅ Environment vocabulary: ${totalCount} total words (${environmentVocabulary.length} in file)`);
    return true;
  } catch (error) {
    if (error instanceof Error && error.name === 'ConstraintError') {
      // Some words might already exist, try to add the rest
      await removeDuplicateVocabulary();
      const existingEnvironment = await db.vocabulary.where('category').equals('environment').toArray();
      const existingIds = new Set(existingEnvironment.map(w => w.id));
      const existingByPolish = new Map<string, VocabularyWord>();
      for (const word of existingEnvironment) {
        const key = `${word.subcategory}_${word.polish.toLowerCase().trim()}`;
        if (!existingByPolish.has(key)) {
          existingByPolish.set(key, word);
        }
      }
      const newWords = environmentVocabulary.filter(word => {
        if (existingIds.has(word.id)) return false;
        const key = `${word.subcategory}_${word.polish.toLowerCase().trim()}`;
        return !existingByPolish.has(key);
      });
      
      if (newWords.length > 0) {
        try {
          await db.vocabulary.bulkAdd(newWords);
          await removeDuplicateVocabulary();
          const totalCount = await db.vocabulary.where('category').equals('environment').count();
          await db.categories.update('environment', { totalWords: totalCount });
          console.log(`✅ Added ${newWords.length} new environment words. Total: ${totalCount}`);
        } catch (e) {
          console.error('Error adding remaining environment words:', e);
        }
      }
      return true;
    }
    console.error('Error seeding environment vocabulary:', error);
    return false;
  }
}
